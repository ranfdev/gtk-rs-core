<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Converts a string from one character set to another, possibly including fallback sequences for characters not representable in the output. Note that it is not guaranteed that the specification for the fallback sequences in `fallback` will be honored. Some systems may do an approximate conversion from `from_codeset` to `to_codeset` in their `iconv()` functions, in which case GLib will simply return that approximate conversion."><title>convert_with_fallback in glib - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-4fd87876916c981b.css" id="mainThemeStyle"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="glib" data-themes="" data-resource-suffix="" data-rustdoc-version="1.73.0-nightly (39f42ad9e 2023-07-19)" data-channel="nightly" data-search-js="search-6dfdfced5eff6596.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-6d2c9675f3d09c26.css" data-theme-dark-css="dark-45ceb8f2e522f4d1.css" data-theme-ayu-css="ayu-fd19013d6ce078bf.css" ><script src="../static.files/storage-db41da1a38ea3cb8.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-0795b7d26be81095.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../static.files/light-6d2c9675f3d09c26.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../static.files/dark-45ceb8f2e522f4d1.css"><link rel="stylesheet" href="../static.files/noscript-cffde32267a19fd6.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]-->
<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", checkDocsLatestStable);

    function checkDocsLatestStable() {
        function popup(msg, url) { return `
            <style scoped="scoped">
                .popup {
                    max-width: 16em;
                    background-color: #fff;
                    position: fixed;
                    z-index: 1;
                    margin-left: auto;
                    bottom: 1em;
                    right: 1em;
                    border-radius: 5px;
                    box-shadow: 1px 1px 4px #777;
                }

                .popup a.version {
                    color: #e57300;
                    padding: 0.6em 1em;
                    display: block;
                }
                .popup a.version:hover {
                    color: #b25900;
                }

                .popup a.close {
                    color: white;
                    background: grey;
                    border-radius: 99px;
                    display: inline-block;
                    width: 19px;
                    line-height: 19px;
                    font-weight: bold;
                    text-align: center;
                    margin: 0.6em;
                    float: right;
                }
                .popup a.close:hover {
                    background: black;
                }
            </style>
            <section class="popup" id="gir_docs_popup">
                <a class="close" href="#" onclick="document.getElementById('gir_docs_popup').remove(); return false">×</a>
                <a class="version" href="https://gtk-rs.org/gtk-rs-core/stable/latest/docs">
                    ⚠ ${msg}
                </a>
            </section>
        ` };

        if ("master" == "master") {
            document.body.insertAdjacentHTML(
                'beforeend',
                popup("This is the development version. Go to latest stable version.", "stable/latest")
            );
        } else {
            fetch('https://gtk-rs.org/gtk-rs-core/LATEST_RELEASE_BRANCH')
                .then(response => response.text())
                .then(latest_branch => {
                    if (latest_branch.trim() != "master") {
                        document.body.insertAdjacentHTML(
                            'beforeend',
                            popup("This version is outdated. Go to latest version.", "stable/latest")
                        );
                    }
                });
        }
    }
</script>


<nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../glib/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../glib/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><div class="sidebar-elems"><h2><a href="index.html">In glib</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Function <a href="index.html">glib</a>::<wbr><a class="fn" href="#">convert_with_fallback</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../src/glib/convert.rs.html#114-146">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub fn convert_with_fallback(
    str_: &amp;[<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>],
    to_codeset: impl <a class="trait" href="trait.IntoGStr.html" title="trait glib::IntoGStr">IntoGStr</a>,
    from_codeset: impl <a class="trait" href="trait.IntoGStr.html" title="trait glib::IntoGStr">IntoGStr</a>,
    fallback: <a class="enum" href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;impl <a class="trait" href="trait.IntoGStr.html" title="trait glib::IntoGStr">IntoGStr</a>&gt;
) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;(<a class="struct" href="collections/slice/struct.Slice.html" title="struct glib::collections::slice::Slice">Slice</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>&gt;, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>), <a class="enum" href="enum.CvtError.html" title="enum glib::CvtError">CvtError</a>&gt;</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Converts a string from one character set to another, possibly
including fallback sequences for characters not representable
in the output. Note that it is not guaranteed that the specification
for the fallback sequences in <code>fallback</code> will be honored. Some
systems may do an approximate conversion from <code>from_codeset</code>
to <code>to_codeset</code> in their <code>iconv()</code> functions,
in which case GLib will simply return that approximate conversion.</p>
<p>Note that you should use [<code>iconv()</code>][crate::iconv()] for streaming conversions.
Despite the fact that <code>bytes_read</code> can return information about partial
characters, the g_convert_… functions are not generally suitable
for streaming. If the underlying converter maintains internal state,
then this won’t be preserved across successive calls to <a href="fn.convert.html" title="fn glib::convert"><code>convert()</code></a>,
<a href="fn.convert.html" title="fn glib::convert"><code>convert()</code></a> or <a href="fn.convert_with_fallback.html" title="fn glib::convert_with_fallback"><code>convert_with_fallback()</code></a>. (An example of
this is the GNU C converter for CP1255 which does not emit a base
character until it knows that the next character is not a mark that
could combine with the base character.)</p>
<h3 id="str"><a href="#str"><code>str</code></a></h3>
<p>the string to convert.</p>
<h3 id="to_codeset"><a href="#to_codeset"><code>to_codeset</code></a></h3>
<p>name of character set into which to convert <code>str</code></p>
<h3 id="from_codeset"><a href="#from_codeset"><code>from_codeset</code></a></h3>
<p>character set of <code>str</code>.</p>
<h3 id="fallback"><a href="#fallback"><code>fallback</code></a></h3>
<p>UTF-8 string to use in place of characters not
present in the target encoding. (The string must be
representable in the target encoding).
If <a href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html#variant.None" title="variant core::option::Option::None"><code>None</code></a>, characters not in the target encoding will
be represented as Unicode escapes \uxxxx or \Uxxxxyyyy.</p>
<h2 id="returns"><a href="#returns">Returns</a></h2>
<p>If the conversion was successful, a newly allocated buffer
containing the converted string, which must be freed with <code>g_free()</code>.
Otherwise <a href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html#variant.None" title="variant core::option::Option::None"><code>None</code></a> and <code>error</code> will be set.</p>
<h3 id="bytes_read"><a href="#bytes_read"><code>bytes_read</code></a></h3>
<p>location to store the number of bytes in
the input string that were successfully converted, or <a href="https://doc.rust-lang.org/nightly/core/option/enum.Option.html#variant.None" title="variant core::option::Option::None"><code>None</code></a>.
Even if the conversion was successful, this may be
less than <code>len</code> if there were partial characters
at the end of the input.</p>
</div></details></section></div></main></body></html>